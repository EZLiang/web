---
layout: default
title: Search Books
---

<style>
</style>


<button onclick="OnBookSearch()">Search</button>
<input id="searchText" type="text" size="60">
<i>(RegExp Supported)</i>
<hr>
<div id="resultList"></div>

<script type="text/javascript" src="manage.js"></script>
<script type="text/javascript">
    "use strict";

    // response <enter> for text box
    let textBox = document.getElementById("searchText");
    textBox.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            OnBookSearch();
        }
    });


    function OnBookSearch()
    {
        function SearchTextInBookGroup(bookGroup, groupIndex, regExp)
        {
            var result = [];
            
            for (var i = 0; i < bookGroup.list.length; i++) {
                var book = bookGroup.list[i];

                if ((book.title.search(regExp) >= 0) ||
                    (book.author.search(regExp) >= 0) ||
                    (book.comment === undefined ? false : book.comment.search(regExp) >= 0) ||
                    (book.description.search(regExp) >= 0))
                {
                    result.push({book:book, groupIndex:groupIndex, bookIndex:i})
                }
            }

            return result;
        }

        var text = document.getElementById("searchText").value;
        if (text == "") {
            alert("no text input for search");
            return;
        }
        var regExp = new RegExp(text, 'i');

        var booksFound = [];
        books.forEach( (bookGroup, groupIndex) => {
            booksFound = booksFound.concat(SearchTextInBookGroup(bookGroup, groupIndex, regExp));
        });

        var resultHtml = '<string>' + booksFound.length + ' books found</strong>';

        booksFound.forEach( bookFound => {
            resultHtml += '<hr>' + FormatBook(bookFound.book, bookFound.groupIndex, bookFound.bookIndex);
        })

        resultHtml += '<hr>';

        document.getElementById("resultList").innerHTML = resultHtml;
    }

</script>
